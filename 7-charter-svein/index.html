<!DOCTYPE html>
<html>
<head>
    <title>Oppgave 7: Kjendiser</title>

    <script src="/bower_components/webcomponentsjs/webcomponents.js"></script>

    <link rel="import" href="/bower_components/polymer/polymer.html">
    <link rel="import" href="/bower_components/core-ajax/core-ajax.html">
    <link rel="import" href="/bower_components/paper-input/paper-input.html">
    <link rel="import" href="/bower_components/paper-button/paper-button.html">
    <link rel="import" href="/bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="/bower_components/core-image/core-image.html">
    <link href="/bower_components/core-icons/core-icons.html" rel="import">
    <link href="/bower_components/core-icon-button/core-icon-button.html" rel="import">
    <link href="/bower_components/core-animated-pages/core-animated-pages.html" rel="import">


    <style>
        body {
          font-family: sans-serif;
        }

        .toolbar {
          background-color: steelblue;
        }

        #container {
          overflow: hidden;
        }

        #noscroll {
          overflow-x: hidden;
          overflow-y: auto;
        }

        .card {
          position: relative;
          height: 150px;
          width: 200px;
          font-size: 30px;
          margin: 8px;
          border-radius: 4px;
          cursor: default;
        }

        .view {
          font-size: 20px;
          background-color: tomato;
        }

  </style>
</head>
<body unresolved fullbleed vertical layout>
    <!--
        Oppgave 7: kjendismania

        Du har blitt leid inn til å lage en oversikt over populære internett-
        karakterer. Listen skal basere seg på data hentet fra URL-en
        "http://ciber-norge.github.io/data/vips.json". Bruk det du har lært
        om Polymer til å presentere listen ved hjelp av template-repeat. Du kan
        bruke elementet "core-ajax" til å hente informasjonen til en variabel.

        Extra credit: Vis video
        Even more credit: Filtrér listn med et input-felt.
    -->

    <polymer-element name="click-frame" attributes="showLabel hideLabel">
        <template>
            <template if="{{!opened}}">
                <paper-button raised on-click="{{open}}">{{showLabel}}</paper-button>
            </template>
            <template if="{{opened}}">
                <content></content>
                <paper-button raised on-click="{{hide}}">{{hideLabel}}</paper-button>
            </template>
        </template>
        <script>
            Polymer({
                opened: false,
                open: function () { this.opened = true; },
                hide: function () { this.opened = false; }
            });
        </script>
    </polymer-element>

    <polymer-element name="kjendis-app">
        <template>
            <core-toolbar class="tall">
                <core-icon-button icon="{{$.pages.selected != 0 ? 'arrow-back' : 'menu'}}" on-tap="{{back}}"></core-icon-button>
                <div class="middle indent">Internet celebrities</div>
                <div class="bottom indent"><paper-input label="Filtrer" floatinglabel="" value="{{filterString}}"></paper-input></div>
            </core-toolbar>
            <section flex>
            <section vertical layout>
                <template if="{{!data}}"><span>Laster...</span></template>
                <div id="noscroll" fit hero-p>
                  <div id="container" flex horizontal wrap around-justified layout cross-fade>
                        <template repeat="{{x in data | filter(filterString)}}">
                              <style>
                                  .card {
                                    position: relative;
                                    font-size: 13px;
                                    margin: 8px;
                                    border-radius: 4px;
                                    cursor: pointer;
                                  }
                            </style>
                            <div class="card" vertical center center-justified layout hero-id="item-{{x.nr}}" hero?="{{$.pages.selected === x.nr + 1 || lastSelected === x.nr + 1}}" on-tap="{{selectView}}">
                                <header>
                                    <core-image style="width:100px; height:100px;" sizing="cover" src="{{x.avatar}}"></core-image>
                                    <h3>{{x.name}}</h3>
                                </header>
                                <div class="celebrity-content">
                                    <p>Occupation: {{x.occupation}}</p>
                                    <p>Category: {{x.category}}</p>
                                    <p><a href="{{x.website}}">Website</a></p>
                                    <p>
                                        <click-frame showLabel="Click to open" hideLabel="Hide the abomination!">
                                            <iframe src="{{x.bestOf}}"></iframe>
                                        </click-frame>
                                    </p>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </section>
        </section>
            
            <core-ajax auto response="{{data}}" url="http://ciber-norge.github.io/data/vips.json"></core-ajax>
        </template>

        <script>
            Polymer({
                filter: function (data, str) {
                    if (!str) return data;

                    return data.filter(function (model) {
                        return model.name.toLowerCase().indexOf(str) > -1 ||
                                model.category.toLowerCase().indexOf(str) > -1 ||
                                model.occupation.toLowerCase().indexOf(str) > -1;
                    });
                }
            });
        </script>
    </polymer-element>

    <kjendis-app></kjendis-app>
</body>
</html>
